<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="styles/menu.css">	
    <link rel="stylesheet" href="gameList.css">
	<script  src="navbar.js"></script>
	<meta charset="utf-8">
	<title> Profile </title>
</head>
<body>
	<nav id="navbar"></nav>
		<div class="card">
			<div class="mid">
				<form id="form">
					<div id="username-wrapper">
						<label for="username">Username: </label>
						<input type="TEXT" placeholder="lucas" name="username">
					</div>
					<div id="password-wrapper">
						<label>Password: </label>
						<input type="PASSWORD" placeholder="new password" name="password">
					</div>
					<div id="upload-wrapper">
						<label>Profile picture: </label>
						<input type="TEXT" placeholder="URL of profile picture" name="pp">
					</div>
					<input type="submit" value="Confirm Changes">
				</form>
			</div>
		</div>
<script>
	window.addEventListener( "load", function () {
		function sendData() {
			const XHR = new XMLHttpRequest();
			const FD = new FormData( form );
			XHR.addEventListener( "load", function(event) {
				  alert( event.target.responseText );
			} );
			XHR.addEventListener( "error", function( event ) {
				alert( 'Oops! Something went wrong.' );
			} );
			XHR.open( "POST", "http://localhost:5555" );
			let user_id = JSON.parse(sessionStorage.userinfo)["user_id"];
			let toSend = {"change_user":user_id};
			toSend["username"] = FD.get('username')
			toSend["password"] = FD.get('password');
			toSend["profile_picture"] = FD.get('pp');	
			XHR.send(JSON.stringify(toSend));
		  }

		  // Access the form element...
		  const form = document.getElementById( "form" );

		  // ...and take over its submit event.
		  form.addEventListener( "submit", function ( event ) {
			event.preventDefault();

			sendData();
		  } );
		} );
	</script>
</body>
</html>
